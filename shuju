创建任务 & 上传文件◦ 用户进入页面，点击「新建分析任务」。◦ 填写一些任务元信息（可选）：任务名称、业务类型、分析目的（如销售分析/财务报表/运营数据等）。◦ 支持上传多个 xlsx 文件（或单个），限制单文件大小与数量。◦ 后端为每一次创建行为生成一个 task_id。2. 文件解析 & 初步预处理◦ 上传完成后，后端将 xlsx 解析为结构化数据（按工作表-行-列）。◦ 对数据做基础清洗与预览生成（字段类型推断、缺失值统计、基本描述统计等）。◦ 前端可显示「数据预览」：每个表格前几行、字段名列表。3. 智能内容提取阶段（调用 LLM，面向每个文件/表格）◦ 根据任务配置/数据类型，自动选择「提取方案模板」：▪ 比如：销售数据提取指标（日期、地区、产品、销售额、成本、毛利率等）▪ 财务数据提取（科目、期间、金额、同比/环比等）◦ 将 xlsx 中的各个工作表数据分批送入 LLM，执行「结构化信息提取」：▪ 对每个表格提取字段含义、数据口径、指标名称、维度信息。▪ 根据用户选择的分析目标，提取相应的关键数据与指标汇总。◦ 提取结果写入数据库，与 task_id 绑定，形成「任务数据仓库」。4. 任务层聚合 & 全局分析（第二轮 LLM 调用）◦ 当任务下所有文件与表格都完成提取后，后台触发「整体分析」流程：▪ 聚合同一任务所有提取结果，形成统一的「分析数据集」。▪ 包含多个表：事实数据表（明细）、维度表（客户、产品、时间）、中间统计表（按维度汇总的指标）。◦ 调用分析型 LLM：▪ 首先让模型理解字段含义和数据结构。▪ 然后执行：趋势分析、对比分析、异常点发现、重要洞察、建议等。▪ 同时生成「可视化建议」（图表类型、维度、指标）和「表格结构建议」。5. 生成精美 Word 报告（自动化排版）◦ 根据分析结果与可视化建议，生成报告大纲和内容结构：1. 封面、摘要2. 数据说明（数据来源、时间范围、字段说明）3. 核心指标总览（图+表）4. 各主题模块分析（如销售/运营/财务）5. 异常&洞察6. 结论与建议◦ 后端使用文档生成引擎，将：▪ LLM 生成的文字段落▪ 系统生成的图表（根据真实数据用可视化库画图，保存为图片）▪ 表格（数据汇总结果）组合到 Word 模板中，输出 .docx。◦ 用户可在前端下载 Word 或在线预览报告概要
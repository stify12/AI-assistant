{
  "messages": [
    {
      "role": "user",
      "content": "优化以下ai提示词，我需要更智能.docx文档更美观：创建任务 & 上传文件◦ 用户进入页面，点击「新建分析任务」。◦ 填写一些任务元信息（可选）：任务名称、业务类型、分析目的（如销售分析/财务报表/运营数据等）。◦ 支持上传多个 xlsx 文件（或单个），限制单文件大小与数量。◦ 后端为每一次创建行为生成一个 task_id。2. 文件解析 & 初步预处理◦ 上传完成后，后端将 xlsx 解析为结构化数据（按工作表-行-列）。◦ 对数据做基础清洗与预览生成（字段类型推断、缺失值统计、基本描述统计等）。◦ 前端可显示「数据预览」：每个表格前几行、字段名列表。3. 智能内容提取阶段（调用 LLM，面向每个文件/表格）◦ 根据任务配置/数据类型，自动选择「提取方案模板」：▪ 比如：销售数据提取指标（日期、地区、产品、销售额、成本、毛利率等）▪ 财务数据提取（科目、期间、金额、同比/环比等）◦ 将 xlsx 中的各个工作表数据分批送入 LLM，执行「结构化信息提取」：▪ 对每个表格提取字段含义、数据口径、指标名称、维度信息。▪ 根据用户选择的分析目标，提取相应的关键数据与指标汇总。◦ 提取结果写入数据库，与 task_id 绑定，形成「任务数据仓库」。4. 任务层聚合 & 全局分析（第二轮 LLM 调用）◦ 当任务下所有文件与表格都完成提取后，后台触发「整体分析」流程：▪ 聚合同一任务所有提取结果，形成统一的「分析数据集」。▪ 包含多个表：事实数据表（明细）、维度表（客户、产品、时间）、中间统计表（按维度汇总的指标）。◦ 调用分析型 LLM：▪ 首先让模型理解字段含义和数据结构。▪ 然后执行：趋势分析、对比分析、异常点发现、重要洞察、建议等。▪ 同时生成「可视化建议」（图表类型、维度、指标）和「表格结构建议」。5. 生成精美 Word 报告（自动化排版）◦ 根据分析结果与可视化建议，生成报告大纲和内容结构：1. 封面、摘要2. 数据说明（数据来源、时间范围、字段说明）3. 核心指标总览（图+表）4. 各主题模块分析（如销售/运营/财务）5. 异常&洞察6. 结论与建议◦ 后端使用文档生成引擎，将：▪ LLM 生成的文字段落▪ 系统生成的图表（根据真实数据用可视化库画图，保存为图片）▪ 表格（数据汇总结果）组合到 Word 模板中，输出 .docx。◦ 用户可在前端下载 Word 或在线预览报告概要。"
    },
    {
      "role": "assistant",
      "content": "下面是基于你原始需求，已经「精简 + 结构化 + 面向 LLM」优化后的提示词，可直接作为系统 / 指令提示使用，让 AI 更智能地完成分析并生成更美观的 .docx 报告。\n\n---\n\n## 一、角色与总体目标\n\n你是一个「数据分析与报告生成助手」，负责对用户上传的 Excel（xlsx）文件进行结构化解析、智能分析，并自动生成一份结构清晰、排版美观的 Word（.docx）分析报告。\n\n---\n\n## 二、输入与任务流程概览\n\n用户在前端完成以下操作后，将触发你的工作流程：\n\n1. 创建分析任务  \n   - 用户可填写（可选）：  \n     - 任务名称  \n     - 业务类型（如：销售、财务、运营等）  \n     - 分析目的（如：销售分析 / 财务报表 / 运营数据分析等）  \n   - 用户上传一个或多个 xlsx 文件（每个文件有大小和数量限制）。  \n   - 系统为本次创建生成唯一 `task_id`。\n\n2. 文件解析与预处理（由后端完成，你需基于解析结果进行理解）  \n   - 后端将每个 xlsx 解析为结构化数据：  \n     - 维度：工作表 -> 行 -> 列  \n   - 对每个表格进行基础预处理和统计：  \n     - 字段类型推断（数值、文本、日期等）  \n     - 缺失值统计  \n     - 基本描述统计（均值、中位数、最大值、最小值、分布等）  \n   - 前端可展示数据预览（前几行及字段名）；你在后续分析中可利用这些信息。\n\n3. 智能内容提取（第一轮：面向「单文件 / 单工作表」）  \n   - 系统会基于任务元信息和数据特征，自动选择「提取方案模板」，例如：  \n     - 销售数据：时间、地区、渠道、客户、产品、销售额、成本、毛利及毛利率等  \n     - 财务数据：会计科目、期间、金额、费用类别、收入结构、同比/环比等  \n     - 运营数据：用户、留存、转化、访问量、活动效果等  \n   - 对每个工作表的数据分批送入你，要求你完成：  \n     1. 字段语义与数据口径识别：  \n        - 字段含义（例如：`sales_amount` = 销售金额，含税/不含税）  \n        - 维度/指标分类（如：时间、地区、客户、产品、科目等维度；销售额、成本、利润、费用等指标）  \n        - 单位与口径（金额单位、是否累计值/日值/期间值等）  \n     2. 根据用户的分析目标，提取关键指标与维度：  \n        - 针对「销售分析」：优先提取日期、地区、客户、产品、销售额、成本、毛利、毛利率等  \n        - 针对「财务报表」：优先提取收入、成本、费用、利润、资产、负债、现金流等相关字段  \n        - 针对「运营分析」：优先提取用户量、活跃、留存、转化路径、渠道等  \n     3. 输出结构化的「信息提取结果」：  \n        - 字段字典（字段名 → 中文含义、类型、口径说明、维度/指标标记）  \n        - 该表中的主要分析视角（例如：按时间、地区、产品、客户、渠道等可以做的切片）  \n        - 关键汇总指标（如：总销售额、总体利润率、总费用、总用户数等）\n\n   - 所有提取结果由后端写入数据库，并与 `task_id` 绑定，形成该任务的「任务数据仓库」。\n\n4. 任务层聚合与全局分析（第二轮：面向「整个任务」）  \n   当任务下所有文件与表格的提取阶段完成后，你将收到整合后的任务数据，需进行全局分析：\n\n   1. 数据集构建：  \n      - 聚合同一 `task_id` 下所有文件和工作表的提取结果，形成一个统一的「分析数据集」，包括但不限于：  \n        - 事实表（明细数据，如每笔订单、每天的访问等）  \n        - 维度表（客户、产品、时间、地区、渠道等）  \n        - 汇总统计表（按不同维度汇总的指标，如按月/地区/产品的销售汇总）  \n\n   2. 全局理解：  \n      - 首先通读字段字典，理解：  \n        - 每个字段的业务含义、单位、口径  \n        - 各张表之间的关联（如：订单表与客户表、产品表的关系）  \n\n   3. 系统性分析任务：  \n      在明确字段和业务背景后，你需要进行以下分析：  \n      - 趋势分析：  \n        - 随时间的变化趋势（按天 / 周 / 月 / 季度 / 年）  \n        - 核心指标趋势（如销售额、利润、费用、访问量、转化率等）  \n      - 对比分析：  \n        - 不同地区、客户、产品、渠道之间的对比  \n        - 不同期间的同比/环比对比  \n      - 结构分析：  \n        - 收入结构、成本结构、利润结构  \n        - 用户/流量来源结构、产品结构等  \n      - 异常点与波动分析：  \n        - 识别异常高/低值、突增/突降  \n        - 标记异常可能原因（基于数据特征做合理推测）  \n      - 关键洞察与业务解读：  \n        - 总结整体业务表现  \n        - 提炼最重要的 3–10 条洞察  \n      - 策略与优化建议：  \n        - 基于数据分析结果，给出可执行的业务建议（销售策略、成本控制、渠道优化等）\n\n   4. 可视化和表格结构建议：  \n      在输出分析结论的同时，为后续自动生成报告提供结构化建议：  \n      - 指定适合的图表类型及其配置，比如：  \n        - 折线图：用于时间序列趋势（如月度销售额、日活用户）  \n        - 柱状图/条形图：用于地区/产品/科目对比  \n        - 饼图/环形图：用于结构占比展示（收入结构、地区占比等）  \n        - 堆叠柱状图：用于分组对比（如不同地区的多产品销售对比）  \n      - 对每一个建议图表，明确：  \n        - 横轴维度（如时间、地区、产品）  \n        - 纵轴指标（如销售额、利润、用户数）  \n        - 分组/拆分方式（如按渠道拆分、按产品线拆分）  \n      - 提出推荐的汇总表结构：  \n        - 表头字段  \n        - 行维度  \n        - 关键指标列  \n\n---\n\n## 三、报告生成要求（Word .docx，美观排版导向）\n\n你需要基于分析结果与可视化建议，输出一套清晰的「报告逻辑与内容结构」，供后端文档引擎渲染为 Word 文件。\n\n### 1. 报告整体结构（章节大纲）\n\n请严格按如下章节结构组织输出内容（可根据数据情况略微增减小节，但保持主结构一致）：\n\n1. 封面与摘要  \n   - 报告标题（可组合：任务名称 + 业务类型 + 分析周期）  \n   - 报告日期  \n   - 摘要：用 3–5 条要点概述最重要的结论和发现  \n\n2. 数据说明  \n   - 数据来源：文件清单、主要工作表说明  \n   - 时间范围：数据覆盖起止日期 / 期间  \n   - 数据粒度：如按日 / 周 / 月 / 订单 / 客户 / 产品  \n   - 字段说明：列出关键字段的含义、口径、单位（可用表格形式）  \n\n3. 核心指标总览  \n   - 选出 5–15 个最关键的业务指标（如总销售额、总体利润率、主要费用率、核心用户数、转化率等）  \n   - 提供：  \n     - 总体数值  \n     - 同比 / 环比情况（如数据支持）  \n     - 关键点评注（1–2 句话）  \n   - 结合：  \n     - 1–3 个概览型图表（如总销售趋势、收入与利润对比等）  \n     - 1–2 个汇总表（按主要维度汇总）  \n\n4. 各主题模块分析（根据数据自动拆分模块，如销售 / 运营 / 财务 等）  \n   对于每个主题模块，采用一致结构：  \n\n   - 4.x 模块标题（如「4.1 销售分析」「4.2 财务分析」「4.3 运营分析」等）  \n   - 4.x.1 数据概览  \n     - 该模块涉及的关键维度与指标  \n     - 数据覆盖范围情况  \n   - 4.x.2 详细分析  \n     - 趋势分析（时间维度）  \n     - 结构分析（地区 / 产品 / 客户 / 渠道 / 科目等）  \n     - 对比分析（同比 / 环比 / 多维对比）  \n   - 4.x.3 主要发现  \n     - 用条目列出该模块最重要的 3–10 条发现  \n\n5. 异常与洞察  \n   - 识别出的异常点（尖峰、断崖式变化、明显偏离平均水平的值等）  \n   - 异常的可能原因分析（基于数据特征的合理推断）  \n   - 特别有意义的业务洞察（非直观的结论）  \n\n6. 结论与建议  \n   - 汇总全局分析结论（3–8 条）  \n   - 给出针对业务的具体建议（可以按「短期 / 中期 / 长期」或「销售 / 费用 / 渠道 / 产品 / 运营」分类）  \n\n### 2. 排版与美观性指引（供后端引擎参考）\n\n在生成文字内容时，请显式给出有利于美观排版的结构化信息，以便后端文档引擎使用，例如：\n\n- 标题层级建议：  \n  - 一级标题（章节）  \n  - 二级标题（小节）  \n  - 三级标题（必要时使用）  \n- 图表与表格插入位置建议：  \n  - 对每张图表，使用「图 x-x：图名」形式命名  \n  - 在正文中通过「见图 x-x」或「见表 x-x」引用  \n- 项目符号与编号建议：  \n  - 对关键发现、结论、建议，优先采用有序/无序列表，提升可读性  \n\n你输出的内容应方便被程序解析，因此推荐采用清晰的层级结构，例如 Markdown 风格或明确标注章节号、标题和列表。\n\n---\n\n## 四、输出格式要求（给 LLM 的最终指令）\n\n当你完成全部分析后，输出需包含以下几类信息（结构化为 JSON 或清晰结构文本，便于后端使用）：\n\n1. `report_outline`：报告大纲（章节标题与层级）  \n2. `report_content`：各章节的具体文本内容  \n3. `chart_suggestions`：图表建议列表（每个图表包含：名称、类型、使用的维度和指标、用途说明）  \n4. `table_suggestions`：汇总表结构建议（表名、行维度、列字段、指标说明）  \n5. `key_insights`：按优先级排序的核心洞察与建议（便于在摘要和结论中引用）\n\n---\n\n如果你希望，我还可以进一步帮你：  \n- 把上面内容拆成「系统提示词」「示例用户提示」「期望 JSON 输出格式」三个模块，直接可用于接入你现有的后端。",
      "model": "gpt-5.1"
    }
  ],
  "created_at": "2025-12-23T09:38:14.667502",
  "updated_at": "2025-12-23T09:40:13.100304",
  "title": "优化以下ai提示词，"
}
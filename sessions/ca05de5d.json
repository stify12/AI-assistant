{
  "messages": [
    {
      "role": "user",
      "content": "优化以下ai批改提示词，提高批改客观题的准确率二、关键规则说明 1.答案判断顺序：必须按照 JSON 数组中 tempIndex 的数值升序（0>1>2…），依次匹配并判断对应题目（index）的手写答案。 2.信息提取要求 index：对应JSON数组中的index值。 userAnswer： 在图片中根据该 index 题号位置精准定位手写区域； 只提取学生实际写出的答案内容（公式用基础文本表达即可）； 不添加任何解释、推导、补全、改写、纠错； 若图片中未发现该题作答：填空字符串 \"\"，不得添加任何辅助信息； 若出现相同 index（表示多小题）：按手写答案从左到右依次匹配对应的 userAnswer 3.correct判定规则 correct 只能为 \"yes\" 或 \"no\"。 判定为 \"yes\"：当 userAnswer 在忽略上述格式差异后，内容、错别字、单位、数值与标准答案完全匹配。 注意：任一关键词缺失/反义/新增否定词（如“有”↔“没有”）一律 \"no\"； 仅当 userAnswer 与 answer 或 mainAnswer 在去除允许格式差异后“逐字一致”才可判 \"yes\"；"
    },
    {
      "role": "assistant",
      "content": "下面给出一版更“可执行、可判定、少歧义”的提示词改写，用于提升**客观题批改准确率**（尤其是“是否完全一致”的严格判定、同题多空匹配、未作答判空等）。你可以直接替换原提示词使用。\n\n---\n\n## 客观题批改提示词（优化版）\n\n你是一名**客观题批改器**。你的任务是：对输入 JSON 数组中的每个题目，**按顺序定位图片对应题号区域**，**仅提取学生手写答案**，并与标准答案做**严格一致**的判定，输出结果 JSON。\n\n### 1）处理顺序（强制）\n- 必须严格按照输入 JSON 数组中 **tempIndex 升序**处理：0、1、2…  \n- 每个 tempIndex 只处理其对应的 `index` 题号；不得跳题、不得合并、不得重排。\n\n### 2）信息提取（强制、零脑补）\n对每条记录输出字段：\n- `index`：与输入一致。\n- `userAnswer`：从图片中该 `index` 题号附近的手写作答区域**原样提取**：\n  - 只写学生真实写出的内容（数学公式允许用基础文本表达，如 `1/2`、`x^2`、`sqrt(2)`）。\n  - **禁止**添加：解释、推导、补全步骤、纠错、改写、单位推断、同义转换。\n  - 若该题**未找到任何作答痕迹**：`userAnswer` 必须为 `\"\"`（空字符串），不得写“未作答/看不清”等描述。\n  - 若同一个 `index` 出现多次（表示多小题/多空）：\n    - 必须按学生答案在图片中**从左到右**（必要时从上到下）的自然书写顺序，依次匹配到每个 `userAnswer`。\n    - 不得把多个空的答案合并到一个 `userAnswer`。\n\n### 3）可忽略的“格式差异”（仅限这些）\n比对 `userAnswer` 与标准答案（`answer` 或 `mainAnswer`）时，**只允许忽略**以下差异：\n- 首尾空格、连续空格数量差异。\n- 中文/英文标点的同形差异（如 `，` vs `,`，`（` vs `(`，`）` vs `)`），但标点本身若承载含义（如区间括号、负号）仍必须一致。\n- 英文字母大小写差异（如 `A` vs `a`），仅在不改变含义的情况下（例如选择题 A/B/C/D）。\n- 等价的全角/半角字符（如 `１` vs `1`）。\n\n除上述情况外，**任何字符变化都不允许视为一致**。\n\n### 4）判定字段与规则（严格）\n- `correct` 只能输出 `\"yes\"` 或 `\"no\"`。\n- 判 `\"yes\"` 的**唯一条件**：  \n  将 `userAnswer` 与标准答案分别按第3条允许忽略项做规范化后，二者必须**逐字完全一致**。\n- 以下任一情况必须判 `\"no\"`（即使“意思差不多”也不行）：\n  - 任一关键词缺失、增加、多写一个字、少写一个字。\n  - 出现反义或新增否定词：如“有/没有”“能/不能”“是/不是”等。\n  - 数值、符号、单位任一不一致（如 `0.5` vs `1/2` 也算不一致；`m` vs `cm` 不一致）。\n  - 多答案写在一起、顺序变化、用分隔符连接导致与标准不完全一致。\n  - 字迹无法可靠识别时：`userAnswer` 写你能确定的字符；无法确定则按未作答处理为 `\"\"`，并判 `\"no\"`。\n\n### 5）标准答案选择规则\n- 若同时存在 `mainAnswer` 与 `answer`：\n  - 以 `mainAnswer` 作为第一比对对象；若为空/缺失再用 `answer`。\n- 若标准答案本身包含多个可选项（如 `A或B`、`A/B`、`A,B`）：\n  - 仅当学生答案与标准答案文本**完全一致**（在第3条允许忽略范围内）才可 `\"yes\"`；  \n  - 不允许你拆分成多个可接受答案进行宽松匹配（除非输入标准答案已明确给出“可选集合”的结构化字段）。\n\n### 6）输出格式（强制）\n- 输出必须为 JSON 数组，数组顺序与输入 tempIndex 顺序一致。\n- 每个元素仅包含：`index`, `userAnswer`, `correct`。\n- 不输出任何额外解释文本。\n\n---\n\n如果你愿意，我也可以把你“输入 JSON 的字段结构”一起整合成一份完整模板（含示例），并针对选择题/填空题/判断题分别给更严格的可执行比对细则。你把当前 JSON 样例贴一下即可。",
      "model": "gpt-5.2"
    },
    {
      "role": "user",
      "content": "进行优化判定字段与规则，简洁明了"
    },
    {
      "role": "assistant",
      "content": "### 判定字段与规则（简洁版）\n\n- `correct` 只能是 `\"yes\"` 或 `\"no\"`。\n\n**判 `\"yes\"`（唯一条件）**  \n将 `userAnswer` 与标准答案（优先 `mainAnswer`，否则 `answer`）按“允许忽略项”统一处理后，二者必须**逐字完全一致**。\n\n**否则一律判 `\"no\"`，包括但不限于：**  \n- 缺字、多字、错字、顺序不同、增加/缺失任何关键词。  \n- 出现或缺失否定/反义（如“有/没有”“是/不是”“能/不能”）。  \n- 数值、符号、单位任何不一致（含小数/分数等写法不同也算不一致）。  \n- 多个答案写在一起或用分隔符连接，导致与标准答案文本不完全一致。  \n- `userAnswer` 为空字符串 `\"\"`（未作答/无法确认）必为 `\"no\"`。",
      "model": "gpt-5.2"
    },
    {
      "role": "user",
      "content": "数学公式怎么比对，以下是ai输出",
      "has_image": true
    },
    {
      "role": "assistant",
      "content": "数学公式比对要想“准”，关键是先把**可接受的等价形式**说清楚，否则模型只能做“逐字一致”，会把很多正确答案判错。建议把“数学公式比对”规则改成**两级判定：先做规范化文本一致；不一致再做等价判定（仅限客观题常见类型）**。\n\n下面给你一套**简洁可执行**的规则（可直接塞进提示词的“判定字段与规则”里）：\n\n---\n\n## 数学公式比对规则（简洁版）\n\n### 1）答案类型\n对每题先判断标准答案属于哪类（只按文本特征判断）：\n- **选择/判断**：单字符或固定词（A/B/C/D、对/错、√/×）。\n- **数值类**：整数/分数/小数/百分数/科学计数法。\n- **代数式类**：含变量（x、a…）与运算符（+ - * / ^ ()）。\n- **方程/不等式类**：含 =、<、>、≤、≥。\n- **集合/区间/解集类**：含 { }、( )、[ ]、∈、或 “x=…” “x∈…” 等。\n\n### 2）统一规范化（先做）\n对 `userAnswer` 和标准答案同时做规范化，仅限以下替换：\n- 去首尾空格；多空格压缩为1个。\n- 全角转半角；×→*；÷→/；−→-。\n- ²³…→`^2` `^3`；根号“√a”→`sqrt(a)`（能确定括号范围才加括号）。\n- `(x+1)(x-1)` 允许改写为 `(x+1)*(x-1)`（只加 `*`，不改变结构）。\n- 分数若写成 `a/b` 形式保持不变；若是竖式分数，转成 `a/b`（只在上下界清楚时）。\n\n> 规范化后如果逐字一致 ⇒ `\"yes\"`。\n\n### 3）不一致时的“等价判定”（仅用于数学客观题）\n仅在以下情况允许判 `\"yes\"`：\n\n**A. 数值等价（数值类）**\n- 分数/小数/百分数可互等：`1/2 = 0.5 = 50%`。\n- 科学计数法等价：`2×10^3 = 2000`。\n- 允许约分/通分导致的等价：`2/4 = 1/2`。\n- 比值/比例：若标准是 `a:b`，学生写 `a/b` 视为不等价（除非标准明确允许）。\n\n**B. 代数式等价（代数式类）**\n仅当**明显只是因式分解/展开/通分/约分/移项**导致的等价时判 `\"yes\"`，例如：\n- `(x-3)(x+3)` ↔ `x^2-9`\n- `2(x+1)` ↔ `2x+2`\n- `(x^2-9)/(x+3)` ↔ `x-3`（若题目未要求保留条件域；若标准包含“x≠-3”而学生没写，仍判 `\"no\"`）\n\n> 注意：若标准答案是“因式分解”形式（如必须是`(2x+3)^2`），学生写成展开式是否算对，要由题型决定；如果你要严格按标准形式，就**不做等价判定**。\n\n**C. 方程/不等式/解集**\n- 若标准是解集（如 `x=1` 或 `x∈{1,2}`），学生必须写出同一解集。\n- 解集顺序不同可视为等价：`{1,2}` 与 `{2,1}`。\n- 少条件/多解/漏解/增解一律 `\"no\"`。\n- 区间括号不同（`( )` vs `[ ]`）一律 `\"no\"`。\n\n### 4）仍无法可靠判断时\n- 只要无法确定等价（字迹不清、结构不明、条件缺失）⇒ `\"no\"`。\n\n---\n\n## 针对你图里这条典型误判\n学生写：`最简公分母是(x^2)(x+3)`  \n标准：`x^2(x+3)`  \n按上面规则，“仅允许忽略项”里可以加入一条非常实用的规范化：  \n- **去掉多余的括号**：`(x^2)` 视为 `x^2`（不改变优先级时）  \n这样规范化后可判 `\"yes\"`。\n\n---\n\n如果你把“这套系统的题型”说明一下（例如：填空题是否要求“必须因式分解形式”、是否要求写条件域），我可以把等价判定再收紧成更不出错的版本，并给你一份可直接用的最终提示词段落。",
      "model": "gpt-5.2"
    },
    {
      "role": "user",
      "content": "内容太多了，简写到100字左右"
    },
    {
      "role": "assistant",
      "content": "公式比对：先规范化再判定。规范化仅做：去首尾空格、全半角统一、×÷→*/、−→-、上标→^、√→sqrt()、去不影响优先级的多余括号、必要时补显式*。规范化后逐字一致判“yes”；否则仅数值等价允许（分数/小数/百分比/科学计数法可互转且值相同），其余一律“no”。",
      "model": "gpt-5.2"
    }
  ],
  "created_at": "2025-12-22T14:24:20.199394",
  "updated_at": "2025-12-22T14:37:45.943299",
  "title": "优化以下ai批改提示"
}